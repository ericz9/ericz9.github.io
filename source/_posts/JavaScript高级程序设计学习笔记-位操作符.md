---
title: JavaScript高级程序设计学习笔记 - 位操作符
date: 2020-12-24 09:21:53
tags: [红宝书, 红宝书第3章（语言基础）]
---
位操作可以直接操作内存中表示数据的比特位。ECMAScript 中的数值都以 IEEE 754 64位格式存储，但位操作是先把值转换为 32 位整数，再进行位操作，之后再把结果转换为 64 位。

有符号整数使用 32 位的前 31 位表示整数值。第 32 位表示数值的符号，如 0 表示正，1 表示负。这一位称为符号位（sign bit），它的值决定了数值其余部分的格式。

# 原码、反码和补码
* 反码即一补数，补码即二补数
* 正数的原码、反码、补码是一致的
* 负数的补码是反码加1，反码就是对原码按位取反，但是符号位不变
* 运算都是基于补码的

# 按位非
对数值取反并减1
```js
let num1 = 25;    // 二进制 00000000000000000000000000011001
let num2 = ~num1; // 二进制 11111111111111111111111111100110
let num3 = -num1 - 1;
console.log(num2); // -26
console.log(num3); // -26
```

# 按位与
两个位都是 1 时返回 1，任一位是 0 时返回 0
```js
// 25: 0000 0000 0000 0000 0000 0000 0001 1001
// 3:  0000 0000 0000 0000 0000 0000 0000 0011
// -------------------------------------------
// =:  0000 0000 0000 0000 0000 0000 0000 0001
let result = 25 & 3;
console.log(result); // 1
```

# 按位或
至少一位是 1 时返回 1，两位都是 0 时返回 0
```js
// 25: 0000 0000 0000 0000 0000 0000 0001 1001
// 3:  0000 0000 0000 0000 0000 0000 0000 0011
// -------------------------------------------
// =:  0000 0000 0000 0000 0000 0000 0001 1011
let result = 25 | 3;
console.log(result); // 27
```

# 按位异或
一位上是 1 的时候返回 1，两位都是 1 或 0，则返回 0
```js
// 25: 0000 0000 0000 0000 0000 0000 0001 1001
// 3:  0000 0000 0000 0000 0000 0000 0000 0011
// -------------------------------------------
// =:  0000 0000 0000 0000 0000 0000 0001 1010
let result = 25 ^ 3;
console.log(result); // 26
```

# 左移
按指定的位数，将数值的所有位向左移动。移位后，右边的空位以 0 填充
```js
let oldValue = 2; // 等于二进制 10
let newValue = oldValue << 5; // 等于二进制 1000000，即十进制 64
```

# 有符号右移
将数值的所有 32 位都向右移，同时保留符号（正或负）。移位后，左边的空位以**符号位的值**填充
```js
let oldValue = 64; // 等于二进制 1000000
let newValue = oldValue >> 5; // 等于二进制 10，即十进制 2
```

# 无符号右移
将数值的所有 32 位都向右移。移位后，左边的空位以 0 填充，而不管符号位是正数还是负数
```js
let oldValue = 64; // 等于二进制 1000000
let newValue = oldValue >>> 5; // 等于二进制 10，即十进制 2
```