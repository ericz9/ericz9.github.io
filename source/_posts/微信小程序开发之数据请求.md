---
title: 微信小程序开发之数据请求
date: 2016-10-21 16:38:29
tags: 微信小程序
---
最近在开发微信小程序的时候，发现使用wx.request进行POST请求时，始终获取不到传递过来的值，查询的时候发现网上还有说只能识别https请求，其实并不是。

其实很简单
1. 设置method为POST
2. 设置Content-Type为application/x-www-form-urlencoded
3. data参数不能再写为Object形式，需转为类似QueryString格式

```javascript
wx.request({
    url: 'http://www.demo.com/api/case',
    data: util.json2Form(paramObject),
    method: 'POST',
    header: {
        'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8'
    },
    success: function(res){
        console.log(res);
    }
})
```
```javascript
function json2Form(json) {  
    var str = [];  
    for(var p in json){  
        str.push(encodeURIComponent(p) + "=" + encodeURIComponent(json[p]));  
    }  
    return str.join("&");  
}
```

***
PS: 其实也不能说是官方文档的问题，只是现在请求头中Content-Type为application/json的格式，有些服务端还不被支持。例如我服务端是使用C#来构建的，如果要解析的话，需要使用Request.InputStream，而不能用Request.Form来获取。